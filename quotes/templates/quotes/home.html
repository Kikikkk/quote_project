<h1>–°–ª—É—á–∞–π–Ω–∞—è —Ü–∏—Ç–∞—Ç–∞</h1>

{% if quote %}
    <blockquote>
        {{ quote.text }}
    </blockquote>
    <p><strong>–ò—Å—Ç–æ—á–Ω–∏–∫:</strong> {{ quote.source }}</p>
    <p><strong>–ü—Ä–æ—Å–º–æ—Ç—Ä–æ–≤:</strong> {{ quote.views }}</p>
    <p>
        <button onclick="vote('like')">üëç <span id="like-count">{{ quote.likes }}</span></button>
        <button onclick="vote('dislike')">üëé <span id="dislike-count">{{ quote.dislikes }}</span></button>
    </p>
    <p><a href="{% url 'add_quote' %}">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Ü–∏—Ç–∞—Ç—É</a></p>

    <script>
      function vote(type) {
        const key = `voted_{{ quote.id }}`;
        if (localStorage.getItem(key)) {
            alert("–í—ã —É–∂–µ –≥–æ–ª–æ—Å–æ–≤–∞–ª–∏ –∑–∞ —ç—Ç—É —Ü–∏—Ç–∞—Ç—É.");
            return;
        }

        fetch(`/${type}/{{ quote.id }}/`, {
            method: 'POST',
            headers: {
                'X-CSRFToken': '{{ csrf_token }}'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (type === 'like') {
                document.getElementById('like-count').innerText = data.likes;
            } else {
                document.getElementById('dislike-count').innerText = data.dislikes;
            }
            localStorage.setItem(key, type); 
        });
      }
  </script>
{% else %}
    <p>–¶–∏—Ç–∞—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.</p>
{% endif %}
